//==// MELPLOT //==//
//0: Tutorial
//1: Tutorial Finished, Sunday night.
//2: Picked up Laura on first day.
//99: Didn't pick up Laura on first day.
//3: Custody Meeting Over (miss: boo!)
//4: Custody Meeting Over (made: yay!)


// room script file
bool is_beccabreakfasting;
bool camehomed;
bool checkedin_hearing;

int timegoneby;//Debug Only

bool offtoschooled;//Meaning that she's started down the stairs.
bool lauratalkable;//Only turned on after she reaches the first floor, so the player doesn't interrupt her.
bool laura_initiated;//not sure what this was for...?
bool laura_autoasked;//Has Laura automatically asked mom to start walking?

function on_event(EventType event, int data) {
  if (event==eEventEnterRoomBeforeFadein){
     musique=(music_slider.Value);
     if (musique<=17) SetMusicVolume(-3);
else if ((musique>=18)&&(musique<=34))SetMusicVolume(-2);
else if ((musique>=35)&&(musique<=50))SetMusicVolume(-1);
else if ((musique>=51)&&(musique<=68))SetMusicVolume(0);
else if ((musique>=69)&&(musique<=85))SetMusicVolume(1);
else if ((musique>=86)&&(musique<=95))SetMusicVolume(2);
else if (musique>=96)SetMusicVolume(3);
SetMusicMasterVolume((music_slider.Value));
       offtoschooled=false;
       camehomed=false;
       is_beccabreakfasting=false;
       laura_autoasked=false;

if ((ampm==0)&&((hour<8)&&(hour>=1))){//Early Morning
SetBackgroundFrame(1);}//dark
if ((ampm==0)&&(hour>=8)&&(hour!=12)){//Morning
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour==12)){//NOON
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour<=8)&&(hour!=12)){//day
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour>=9)&&(hour!=12)){//Night
SetBackgroundFrame(1);}//dark
if ((ampm==0)&&(hour==12)){//Midnight
SetBackgroundFrame(1);}//dark

SetTimer(1, 40);

lauratalkable=true; laura_initiated=false;
Laura.Transparency=0; Rebecca.Transparency=0;
Laura.Baseline=0; Rebecca.Baseline=0;//Resetting this here

if (player.PreviousRoom==29){player.ChangeView(80); player.SetIdleView(81, 0);}//Wakes up in PJs

if (melplot==1){//Before school ends on Monday.
if ((milhour<=6)||(milhour>=20)){Rebecca.ChangeRoom(2, 310, 125); Rebecca.Baseline=10; Rebecca.Animate(0, 3, eRepeat, eNoBlock);}//Early Morning
if (milhour==7){
  if (minute<30){Rebecca.ChangeRoom(2, 170, 192); Rebecca.Animate(5, 3, eRepeat, eNoBlock);}//Seven, Early
  if (minute>=30){Rebecca.ChangeRoom(2, 170, 192);Rebecca.Animate(5, 3, eRepeat, eNoBlock);}}//Seven, Late
if ((milhour>7)&&(milhour<16)){Rebecca.ChangeRoom(24, 10, 10); Rebecca.Animate(0, 3, eRepeat, eNoBlock);}//Daytime
if ((milhour>16)&&(milhour<20)){Rebecca.ChangeRoom(2, 310, 125); Rebecca.Animate(0, 3, eRepeat, eNoBlock);}//Afternoon
}

if (melplot==99){//Mel didn't pick up Laura
Rebecca.ChangeRoom(2, 380, 192); Rebecca.Animate(0, 3, eRepeat, eNoBlock);
Laura.ChangeRoom(24, 222, 118); Laura.ChangeRoom(24, 10, 10);}

if ((hour>=7)&&(hour<=11)&&(mel_lostcustody==false)&&(player.PreviousRoom==29)){//Becca wakes Melanie
  salebuyer=("Rebecca"); 
  if (hour==6){}//Punish-mints
  if (hour==7){vitality.Width-=10;}
  if (hour==8){vitality.Width-=20;}
  if (hour==9){vitality.Width-=30;}
  if (hour==10){vitality.Width-=40;}
  if (hour==11){vitality.Width-=50;}
  hour=6; ampm=0; milhour=6; minute=35;//TimeSet
  is_beccabreakfasting=true;
}

//Regular starts
if ((melplot>=2)&&(melplot!=99)){//After school ends on Monday.
if ((milhour<=6)||(milhour>=20)){Laura.ChangeRoom(2, 222, 59); Rebecca.ChangeRoom(2, 310, 125); Rebecca.Baseline=10; Rebecca.Animate(0, 3, eRepeat, eNoBlock);}//Early Morning
if (milhour==7){
  if (minute<30){Laura.ChangeRoom(2, 222, 59); Rebecca.ChangeRoom(2, 170, 192); Rebecca.Animate(5, 3, eRepeat, eNoBlock);}//Seven, Early
  if (minute>=30){Laura.SetWalkSpeed(10, 10); Laura.ChangeRoom(2, 370, 192); Rebecca.ChangeRoom(2, 192, 192);Rebecca.Animate(5, 3, eRepeat, eNoBlock);}}//Seven, Late
if ((milhour>7)&&(milhour<16)){Laura.ChangeRoom(24, 222, 118); Rebecca.ChangeRoom(24, 10, 10);}//Daytime
if ((milhour==16)||(milhour==17)){Laura.ChangeRoom(2, 370, 192); Rebecca.ChangeRoom(24, 10, 10);}//Daytime
if ((milhour>17)&&(milhour<20)){Laura.ChangeRoom(2, 260, 125); Rebecca.ChangeRoom(2, 310, 125); Rebecca.Animate(0, 3, eRepeat, eNoBlock);}//Afternoon
}

if ((firstdayhome==true)&&(melplot!=99)&&(dayofweek>=1)){//First day walking Laura Home
  Laura.ChangeRoom(2, 370, 192); Rebecca.ChangeRoom(24, 10, 10);}

player.Transparency = 0;
player.ManualScaling = true;
player.Scaling = 95;

if (Rebecca.Room==2){
  Rebecca.ManualScaling = true;
  Rebecca.Scaling = 90;
  }
if (Laura.Room==2){
  Laura.ManualScaling = true;
  Laura.Scaling = 90;
  }

leave.Transparency=99;
NatMusic(9);

if (melplot==0){//Starting out
  Laura.ChangeRoom(4, 100, 100); 
  Rebecca.ChangeRoom(2, 282,  58);}

//Just making sure.
if (mel_lostcustody==true){Laura.ChangeRoom(0);}
if (dayspassed==-1){Laura.ChangeRoom(0);}
if ((dayspassed==0)&&(hour<=16)){Laura.ChangeRoom(0);}

if (is_beccabreakfasting==true){
  Rebecca.x=player.x+10; Rebecca.y=player.y; Rebecca.Baseline=0;
  }

SetTimer(4, 0);
if ((mel_lostcustody==false)&&(day=="Saturday")){//Seth's here to pick up Laura
  SetTimer(4, 200);}
  
///aaaannnnd the blocks.
block_1.Visible=true; block_1.Transparency=0; block_2.Visible=true; block_2.Transparency=0; block_3.Visible=true; block_3.Transparency=0;
if (player.y<60){block_3.Visible=false;}
if ((player.y>60)&&(player.y<140)){block_2.Visible=false;}
if (player.y>140){block_1.Visible=false;}
}}


function lauratalk(){//Laura
if (lauratalkable==true){
if (( ((Laura.x - player.x) <= 60) && (Laura.x - player.x) >= 0)&& (Laura.Room==player.Room)&&( ((Laura.y-player.y)<= 5)&&(Laura.y-player.y)>=-5)){//in Range 
Laura.StopMoving();
salebuyer=("Laura"); customerlisten(); PCListen();
TalkPop(); Wait(40);
customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
    if (milhour==7){
    customertalk(); PCListen();
    if (approval_laura<=0){dText.Text=("...");}
    if (approval_laura==1){dText.Text=("What, you're coming with?");}
    if (approval_laura==2){dText.Text=("Let's go already.");}
    if (approval_laura==3){dText.Text=("Ready to go, finally?");}
    if (approval_laura==4){dText.Text=("Ready to go?");}
    if (approval_laura==5){dText.Text=("Hey, mom - you ready to go?");}
    if (approval_laura>=6){
    int loverandowalk=Random(4);
    if (loverandowalk==0){dText.Text=("Think we'll meet anybody new on the way there?");}
    if (loverandowalk==1){dText.Text=("Let's go right now so I'm not late!");}
    if (loverandowalk==2){dText.Text=("Think it'll be a good day, today? Come on, let's go!");}
    if (loverandowalk==3){dText.Text=("Ready when you are, mom!");}
    if (loverandowalk==4){dText.Text=("Nice day for a walk, isn't it?");}
    }
    blab1(); walkscene_direction=0;
    customerlisten(); dText.Text=(" "); dLauraHeadout.Start();
    }
  else {
        customertalk(); PCListen();
    if (approval_laura<=0){dText.Text=("...");}
    if (approval_laura==1){dText.Text=("What?");}
    if (approval_laura==2){dText.Text=("Hi, mom.");}
    if (approval_laura==3){dText.Text=("Hey, mom.");}
    if (approval_laura==4){dText.Text=("Hey-hey, momma-momma.");}
    if (approval_laura==5){dText.Text=("Shoop-a-doop-doop.");}
    if (approval_laura>=6){dText.Text=("La la la la.");}
    blab1(); customerlisten(); dText.Text=(" ");
    StopPop(); Wait(40);
  }
}
else{}
}}//Laura

function shufflearound(){
//Display("Shuffle Called"); 
SetTimer(1, 40);
if (Laura.Room==2){
  if (milhour<6){}//Nothin'
  if (milhour==7){//Coming downstairs
     if (Laura.y<=118){
       if (offtoschooled==false){
       lauratalkable=false;
       Laura.SetWalkSpeed(2, 2);
       offtoschooled=true;
       Laura.Walk(302, Laura.y, eNoBlock, eAnywhere);
       Laura.AddWaypoint(235, 126);
       Laura.AddWaypoint(252, 126);
       Laura.AddWaypoint(320, 194);
       Laura.AddWaypoint(397, 194);
       }
  }
      if ((Laura.x==397)&&(Laura.y==194)){
      lauratalkable=true;
      //Laura.SetWalkSpeed(1, 1);
      Laura.Walk(380, 194, eNoBlock, eAnywhere);
      Laura.AddWaypoint(370, 194);
      }
      if ((Laura.x==370)&&(Laura.y==194)){
      //Laura.SetWalkSpeed(1, 1);
      //Laura.Walk(395, 192, eNoBlock, eAnywhere);
      if (Laura.Loop!=5){Laura.Animate(5, 4, eRepeat, eNoBlock);}
      }
  }//End 7:00

  if (milhour==8){//Leaving for School
    if (approval_laura>=5){approval_laura=4;}//Whoa! She's mad!
    Laura.StopMoving(); CloseAll();
    salebuyer=("Laura"); customerlisten(); PCListen();
    TalkPop(); Wait(40);
    customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
    customertalk(); dText.Text=("I'm going to school!");blab1();
    customertalk(); dText.Text=("Guess I'll just go by myself!");blab1();
    customertalk(); dText.Text=("Bye everybody!");blab1();
    customerlisten(); dText.Text=(" "); StopPop();
    Wait(40);
    FadeOut(20); Wait(5);
    Laura.ChangeRoom(24, 10, 10);
    Wait(5); FadeIn(20);
    }
    
  if (milhour==16){//Going Upstairs
      if (Laura.y>=192){
          Laura.Walk(397, 192, eNoBlock, eAnywhere);
       Laura.AddWaypoint(320, 192);
       Laura.AddWaypoint(260, 126);
       Laura.AddWaypoint(235, 126);
       Laura.AddWaypoint(302, 118);
       Laura.AddWaypoint(222, 118);
  }}
}//End Laura

}


function region1_Standing(){
    if ((block_2.Visible==true)&&(block_2.Transparency!=50)){block_2.Transparency=50;}
//UP Arrow
if (((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(gBuyortalk.Visible==false)&&(gStock.Visible==false)){//UP
if ((gDialog.Visible==true)||(gPick.Visible==true)||(gStock.Visible==true)){}
else {
       FadeObjectOut_NoBlock(block_2, 100, 0);
       FadeObjectIn_NoBlock(block_1, 100, 0);
       player.UnlockView(); 
       player.LockView(5); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(248, 125, eBlock, eAnywhere);
    }
}}

function region2_Standing(){
  if ((block_1.Visible==true)&&(block_1.Transparency!=50)){block_1.Transparency=50;}
  
if (((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(gBuyortalk.Visible==false)&&(gStock.Visible==false)){//UP
if ((gDialog.Visible==true)||(gPick.Visible==true)||(gStock.Visible==true)){}
else { FadeObjectOut_NoBlock(block_1, 100, 0);
       FadeObjectIn_NoBlock(block_2, 100, 0);
       player.UnlockView();
       player.LockView(6); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(322, 190, eBlock, eAnywhere);
       player.UnlockView();
}}
       if ((IsKeyPressed(380)==1)||(IsKeyPressed(83)==1)&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(gBuyortalk.Visible==false)&&(gStock.Visible==false)){//Down
       FadeObjectOut_NoBlock(block_1, 100, 0);
       FadeObjectIn_NoBlock(block_2, 100, 0);
       player.UnlockView();
       player.LockView(6); 
       player.Animate(0, 1, eRepeat, eNoBlock, eForwards);
       player.Walk(322, 190, eBlock, eAnywhere);
       player.UnlockView();
       }
}


function setharrives(){
  
  if (melplot!=99){//Seth arrives.
CloseAll();
TopUp("That's the doorbell.","Seth must be here to pick up Laura for the weekend.");
FadeOut(10);
Wait(5);
Seth.ChangeRoom(2, 390, 192); 
Rebecca.ChangeRoom(2, 170, 192); Rebecca.Animate(5, 3, eRepeat, eNoBlock);
Laura.ChangeRoom(2, 400, 192);
player.x=360;
player.y=192;
Wait(5);
FadeIn(5);
Seth.Walk(380, 192, eNoBlock, eAnywhere);
Laura.Walk(390, 192, eBlock, eAnywhere);
TalkPop(); Wait(20);
salebuyer=("Seth"); customerlisten(); PCListen();
dName.Text=(" "); dText.Text=(" ");
//Sethbadmom
customertalk(); PCListen(); dText.Text=("Hey guys! How's your week been?"); blab1();
customerlisten(); PCTalk(); dText.Text=("Hi, Seth..."); blab1();
customertalk(); PCListen(); dText.Text=("Man, it smells nice in here. Aunt becca been cooking?"); blab1();
customerlisten(); PCTalk(); dText.Text=("Yeah."); blab1();
customerlisten(); PCTalk(); dText.Text=("I mean... yep."); blab1();
customertalk(); PCListen(); dText.Text=("Is the kiddo all set to go for the weekend?"); blab1();
salebuyer=("Laura"); 
customertalk(); PCListen(); dText.Text=("Bye, mom."); blab1();
PCTalk(); customerlisten(); dText.Text=("Bye, kiddo."); blab1();
salebuyer=("Seth"); 
customertalk(); PCListen(); dText.Text=("Bye, everybody."); blab1();
customerlisten(); PCListen(); dText.Text=(" "); 
StopPop(); 
//[seth exits]
Seth.Walk(390, 192, eNoBlock, eAnywhere); Laura.Walk(390, 192, eBlock, eAnywhere);
FadeOut(20);
Wait(5);
Seth.ChangeRoom(4, 100, 100); Laura.ChangeRoom(4, 100, 100);
Wait(5); FadeIn(20);
mel_lostcustody=true;//SETTING THIS FOR THE WEEKEND, ETC.
}

else if (melplot==99){//Seth arrives.
CloseAll();
TopUp("That's the doorbell.","Seth must be here with Laura.");
FadeOut(10);
Wait(5);
Seth.ChangeRoom(2, 390, 192); 
Rebecca.ChangeRoom(2, 170, 192); Rebecca.Animate(5, 3, eRepeat, eNoBlock);
Laura.ChangeRoom(2, 400, 192);
player.x=360;
player.y=192;
Wait(5);
FadeIn(5);
Seth.Walk(380, 192, eNoBlock, eAnywhere);
Laura.Walk(390, 192, eBlock, eAnywhere);
TalkPop(); Wait(20);
salebuyer=("Seth"); customerlisten(); PCListen();
dName.Text=(" "); dText.Text=(" ");
//Sethbadmom
customerlisten(); PCTalk(); dText.Text=("Hey, guys."); blab1();
customertalk(); PCListen(); dText.Text=("Hi Melanie! Haven't seen this place in a while."); blab1();
customerlisten(); PCTalk(); dText.Text=("Hi, Seth..."); blab1();
customertalk(); PCListen(); dText.Text=("Looks nice in here. Looks like Becca got those pictures framed after all."); blab1();
customertalk(); PCListen(); dText.Text=("They look good behind glass like that."); blab1();
customerlisten(); PCTalk(); dText.Text=("Yeah..."); blab1();
customertalk(); PCListen(); dText.Text=("So, you guys all set here? Do you need anything? I can run to the store, if you want."); blab1();
customerlisten(); PCTalk(); dText.Text=("No, we don't need anything. Becca's cooking right now, I think."); blab1();
customertalk(); PCListen(); dText.Text=("Oh, great! You and Laura are gonna eat pretty well while living here, aren't you? "); blab1();
customertalk(); PCListen(); dText.Text=("Becca's such a good cook and all. A true chef, really."); blab1();
customerlisten(); PCTalk(); dText.Text=("You're right. She's great."); blab1();
customertalk(); PCListen(); dText.Text=("Well, I'll leave you two to get settled in! Nice seeing you! Take care!"); blab1();
customerlisten(); 
PCTalk(); dText.Text=("Bye, Seth."); blab1();
customerlisten(); PCListen(); dText.Text=(" "); 
StopPop(); 
//[seth exits]
Seth.Walk(390, 192, eBlock, eAnywhere);
Seth.ChangeRoom(4, 100, 100);
salebuyer=("Laura");
TalkPop(); Wait(30);
customertalk(); PCListen(); dText.Text=("..."); blab1();
customerlisten(); PCTalk(); dText.Text=("Excited to see your room?"); blab1();
customertalk(); PCListen(); dText.Text=("I'm just upstairs, right? In the attic?"); blab1();
customerlisten(); PCTalk(); dText.Text=("Yeah, I hope you like it. We've got your computer in there and all the books you can read!"); blab1();
customertalk(); PCListen(); dText.Text=("..."); blab1();
customertalk(); PCListen(); dText.Text=("It's only a week, right? Then I can go home?"); blab1();
customerlisten(); PCTalk(); dText.Text=("For now. We're... Your dad and I are going to work on a more solid, you know, \"schedule\" tomorrow."); blab1();
customertalk(); PCListen(); dText.Text=("Okay. Fine."); blab1();
customerlisten(); PCTalk(); dText.Text=("Do you want to see the coffee stand tomorrow? We can go after school and you can tell me what you think."); blab1();
customertalk(); PCListen(); dText.Text=("Maybe, but I'll probably have homework and stuff."); blab1();
customerlisten(); PCTalk(); dText.Text=("You know, your aunt Becca is great at math. She'd love to help."); blab1();
customertalk(); PCListen(); dText.Text=("I can handle it, mom. I'm gonna work on science."); blab1();
customerlisten(); PCTalk(); dText.Text=("Let me know if you need any help. All right, sweety?"); blab1();
customertalk(); PCListen(); dText.Text=("..."); blab1();
customerlisten(); PCListen(); dText.Text=(" "); 
Rebecca.SetWalkSpeed(5, 5);
Laura.SetWalkSpeed(7, 7);
StopPop(); 
       Laura.Walk(397, 192, eBlock, eAnywhere);
       Laura.AddWaypoint(330, 192);
       Laura.AddWaypoint(255, 126);
       Laura.AddWaypoint(235, 126);
       Laura.AddWaypoint(302, 59);
       Laura.AddWaypoint(222, 59);
    //[Becca comes over]
    Rebecca.Walk(player.x+15, 192, eBlock, eAnywhere);
    Wait(60);
salebuyer=("Rebecca");
TalkPop(); Wait(30);
customertalk(); PCListen(); dText.Text=("Seth didn't seem upset?"); blab1();
customerlisten(); PCTalk(); dText.Text=("No, of course not."); blab1();
customertalk(); PCListen(); dText.Text=("What do you mean?"); blab1();
customerlisten(); PCTalk(); dText.Text=("He's pretty satisfied that I'm already falling apart. I haven't even gotten started yet and I've already screwed up once."); blab1();
customertalk(); PCListen(); dText.Text=("Come on, Melanie. It's okay."); blab1();
customertalk(); PCListen(); dText.Text=("There's a lot on your plate right now, but you'll be fine. Just don't forget about the custody hearing. It's tomorrow, right?"); blab1();
customerlisten(); PCTalk(); dText.Text=("Yeah. We're meeting at the courthouse at noon."); blab1();
customertalk(); PCListen(); dText.Text=("Okay. And you're walking Laura to school in the morning?"); blab1();
customerlisten(); PCTalk(); dText.Text=("Every morning, while she's here."); blab1();
customertalk(); PCListen(); dText.Text=("Okay, okay."); blab1();
customertalk(); PCListen(); dText.Text=("I don't want to burn the food, so I'm going to get back to work."); blab1();
customerlisten(); PCTalk(); dText.Text=("..."); blab1();
customertalk(); PCListen(); dText.Text=("You're doing fine. Just get through this week in one piece and everything will be fine after that."); blab1();
customerlisten(); PCTalk(); dText.Text=("You're right. Thanks."); blab1();
customerlisten(); PCListen(); dText.Text=(" "); 
StopPop();
//[fadeout, places]
FadeOut(20);
Wait(5);
Laura.ChangeRoom(2, 222, 59); 
Rebecca.ChangeRoom(2, 170, 192); Rebecca.Animate(5, 3, eRepeat, eNoBlock);
Rebecca.SetWalkSpeed(3, 3);
melplot=2;//Check this int's meaning at the top of this page.
Wait(5);
FadeIn(20);
}

}


function room_RepExec(){

if ((ampm==0)&&((hour<8)&&(hour>=1))){//Early Morning
SetBackgroundFrame(1);}//dark
if ((ampm==0)&&(hour>=8)&&(hour!=12)){//Morning
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour==12)){//NOON
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour<=8)&&(hour!=12)){//day
SetBackgroundFrame(0);}//light
if ((ampm==1)&&(hour>=9)&&(hour!=12)){//Night
SetBackgroundFrame(1);}//dark
if ((ampm==0)&&(hour==12)){//Midnight
SetBackgroundFrame(1);}//dark

if (IsTimerExpired(4)){setharrives();}

if ((lauratalkable==true)&&(laura_autoasked==false)&&(Laura.y==194)&&(hour==7)){////she's waiting
if (( ((Laura.x - player.x) <= 60) && (Laura.x - player.x) >= 0)&& (Laura.Room==player.Room)&&( ((Laura.y-player.y)<= 5)&&(Laura.y-player.y)>=-5)){//in Range 
laura_autoasked=true;
lauratalk();//Auto-talk for going to school
}}

if (((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(gBuyortalk.Visible==false)&&(gStock.Visible==false)){//UP
if ((gDialog.Visible==true)||(gPick.Visible==true)||(gStock.Visible==true)){}
else {//Uptalk!

//Rebecca
if (( ((Rebecca.x-player.x)<= 60)&&(Rebecca.x-player.x)>=0)&&(Rebecca.Room==player.Room)&&( ((Rebecca.x-player.y)<= 5)&&(Rebecca.y-player.y)>= -5)){//in Range 
Rebecca.StopMoving();
salebuyer=("Rebecca"); customerlisten(); PCListen();

  if (GetGlobalInt(107)!=0){
  TalkPop(); Wait(40); customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
  customertalk(); dText.Text=("Did you try the spacebar, yet?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("No, not yet."); blab1();
  customertalk(); PCListen(); dText.Text=("Well, come on, then."); blab1();
  customerlisten(); PCListen(); dText.Text=(" "); 
  StopPop();
  }//tutorial
  else{//Regular (no tutorial)
    if (Rebecca.Loop==5){//Cooking
    TalkPop(); Wait(40); customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
    if (approval_Rebecca<=2){
      customerlisten(); PCListen(); DBG2.Animate(255, 3, 2, eRepeat); dName.Text=("Rebecca: "); dText.Text=("..."); blab1();
      customertalk(); PCListen(); DBG2.Animate(255, 2, 2, eRepeat);
          if (milhour<=12){dText.Text=String.Format("It's just %s.",becca_dish1); blab1();}//Breakfast
          if (milhour>12){dText.Text=String.Format("It's just %s.",becca_dish2); blab1();}//Dinner
      customertalk(); PCListen(); DBG2.Animate(255, 2, 2, eRepeat); dText.Text=("You want any, or what?"); blab1();
      }
    if ((approval_Rebecca>2)&&(approval_Rebecca<5)){
      TalkPop(); Wait(40); customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
      customertalk(); PCListen(); DBG2.Animate(255, 2, 2, eRepeat); 
                if (milhour<=12){dText.Text=String.Format("I made some %s.",becca_dish1); blab1();}
                if (milhour>12){dText.Text=String.Format("I made some %s.",becca_dish2); blab1();}
      customertalk(); PCListen(); DBG2.Animate(255, 2, 2, eRepeat); dText.Text=("You can have some if you want. There'll be leftovers."); blab1();}
    if (approval_Rebecca>=5){
      int nickname=Random(4);
      customertalk(); PCListen(); 
      if (nickname==0){dText.Text=("Hey, Melasaurus."); blab1();}
      if (nickname==1){dText.Text=("Hey there, Coffee lady."); blab1();}
      if (nickname==2){dText.Text=("If it isn't my big sister!"); blab1();}
      if (nickname==3){dText.Text=("Hey, sis!"); blab1();}
      if (nickname==4){dText.Text=("You look hungry."); blab1();}
    customertalk(); PCListen(); 
    if (milhour<=12){dText.Text=String.Format("I'm making %s!",becca_dish1); blab1();}//Breakfast
    if (milhour>12){dText.Text=String.Format("I'm making %s!",becca_dish2); blab1();}//Dinner
    }
    customerlisten(); PCListen(); dText.Text=(" "); 
    dBecca_wantsome.Start();}//End Cooking
    else {//Not cooking
    if ((Rebecca.x==310)&&(Rebecca.y==125)){TopUp("I can hear her snoring.","Rebecca's asleep.");}//Asleep
    else{
    TalkPop(); Wait(40); customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
    if (approval_Rebecca<=2){customerlisten(); PCListen(); DBG2.Animate(255, 3, 2, eRepeat); dName.Text=("Rebecca: "); dText.Text=("..."); blab1();}
    if ((approval_Rebecca>2)&&(approval_laura<5)){customertalk(); PCListen(); dText.Text=("What is it?"); blab1();}
    if (approval_Rebecca>=5){customertalk(); PCListen(); dText.Text=("Hey, Mel. What's shakin'?"); blab1(); }
    customerlisten(); PCListen(); dText.Text=(" "); 
    StopPop();}}//End NotCooking
  }//End Non-tutorial dialog
}//End Rebecca

if (( ((Laura.x - player.x) <= 60) && (Laura.x - player.x) >= 0)&& (Laura.Room==player.Room)&&( ((Laura.y-player.y)<= 5)&&(Laura.y-player.y)>=-5)&&(gDialog.Visible==false)){//in Range 
lauratalk();}//Autotalk

}}//End Uptalk

if (IsTimerExpired(1)==1){shufflearound();}

//if ((milhour<10)&&(Laura.y>140)&&(laura_initiated==false)){laura_initiated=true; lauratalk();}//The fuck is this?!

//==// TUTORIAL STUFF //==//
if (GetGlobalInt(107) == 99) {//Tutorial menu close
 if (gStand_Gui.Visible == true){}
 else {
   TalkPop();
   while(gDialog.Y<80){gDialog.Y+=5; Wait(1);}//Experimental!
   SetTimer(11, 43);
   dName.Text=(" "); dText.Text=(" ");
   SetGlobalInt(107, 0);}}//Tutorial 2nd Half Setup 

if (IsTimerExpired(11)==1){//Tutorial Second Half Runtime
  dName.Visible=true; dText.Visible=true; 
  SetGlobalInt(101, 0);//Tutorial functions lock down franklin's exits, so we have to reset it here.
  PCListen(); customertalk(); dText.Text=("Did it work?"); blab1();
  PCTalk(); customerlisten(); dText.Text=("Yeah - I think so."); blab1();
  PCListen(); customertalk(); dText.Text=("Cool. Great. Mine's spacebar, too."); blab1();
  customertalk(); PCListen(); dText.Text=("Anyways, once you get your equipment, you can adjust your menu prices from that screen. "); blab1();
  customertalk(); PCListen(); dText.Text=("Also, you can use it to check the time as long as you've still got your phone or your watch."); blab1();
  customerlisten(); PCTalk(); dText.Text=("Okay."); blab1();
  customertalk(); PCListen(); dText.Text=("Hey, that reminds me... Didn't Seth give you that watch?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("Yeah. So?"); blab1();
  customertalk(); PCListen(); dText.Text=("Are you going to sell it?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("What? What do you mean?"); blab1();
  customertalk(); PCListen(); dText.Text=("I'm just saying... Starting a business can be expensive. "); blab1();
    boxadd("Loyal Pawn"); 
  customertalk(); PCListen(); dText.Text=("You might consider going to the pawn shop to sell your watch. Couldn't hurt to have the extra money."); blab1();
  customerlisten(); PCTalk(); dText.Text=("I'll think about it."); blab1();
  customertalk(); PCListen(); dText.Text=("...?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("I like this watch!"); blab1();
  customertalk(); PCListen(); dText.Text=("Okay fine. Fine."); blab1();
  customertalk(); PCListen(); dText.Text=("What else did you want to know?"); blab1();
  customerlisten(); PCListen(); dText.Text=(" ");
  //StopPop();//This ends here until the tutorial questions are plugged in.
  dMel_Tut2.Start();  
}//end tutorial second half

  //if ((IsTimerExpired(4)!=1)&&(melplot==99)&&(cheatbiking==true)){
  //timegoneby+=1;
  //Display("Timer 4: %d[Timegoneby: %d[Timer on? %d",IsTimerExpired(4), timegoneby);}
  
if ((Rebecca.y>175)&&(Rebecca.Baseline!=1)){Rebecca.Baseline=1;}
if ((stereopower==0)&&(GetCurrentMusic()==-0)){NatMusic(9);}
if ((Laura.x==397)&&(Laura.y==192)){ if (Laura.WalkSpeedX==2){Laura.StopMoving(); Laura.SetWalkSpeed(1, 1);}}
if ((Rebecca.x==170)&&(Rebecca.y==192)&&(Rebecca.Loop!=5)){Rebecca.Animate(5, 3, eRepeat, eNoBlock);}

}//End Repex

function region3_Standing(){//Front Door
if(((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gStand_Gui.Visible==false)&&(gGui1.Visible==false)&&(gMake.Visible==false)&&(gDialog.Visible==false)&&(gPrice_Gui.Visible==false)){
      if (melplot!=99){//Good mom.
       if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)){ //YES
         if (gInfo.Visible)InfoStop();
         SetGlobalInt(98,2);
         player.ChangeRoom(10, 100, 100);}}
       if (melplot==99){//Bad mom! Seth's coming
        if ((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1)){ //YES
        TalkPop(); Wait(40);
        PCListen(); dName.Text=(" "); dText.Text=(" ");
        PCTalk(); dText.Text=("...Seth's bringing Laura...?"); blab1();
        PCTalk(); dText.Text=("...Ughgh..."); blab1();
        PCListen(); dText.Text=(" ");
        StopPop();
       }}
}}

int doornotice=0;
function region3_WalksOnto() {if ((gInfo.Visible==false)&&(doornotice==0)){    InfoPop(3278, 117); doornotice=1;}}
function region3_WalksOff()  {}

function room_Leave(){
player.ManualScaling = false;
}

function region9_Standing(){//Bed
if(((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gStand_Gui.Visible==false)&&(gGui1.Visible==false)&&(gMake.Visible==false)&&(gDialog.Visible==false)&&(gPrice_Gui.Visible==false)){
  if ((vitality.Width<60)&&(gToothbrushing.Visible==false)){dSleep.Start();}
  else{}
}}

function region4_Standing(){//Pictures
if(((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gStand_Gui.Visible==false)&&(gGui1.Visible==false)&&(gMake.Visible==false)&&(gDialog.Visible==false)&&(gPrice_Gui.Visible==false)){
  pick.NormalGraphic=1778; gPick.Centre(); gPick.Visible=true; close_pick.Visible=true; mouse.Visible=true;}
}

function region5_Standing(){
if(((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gStand_Gui.Visible==false)&&(gGui1.Visible==false)&&(gMake.Visible==false)&&(gDialog.Visible==false)&&(gPrice_Gui.Visible==false)){
  //if (Rebecca.Loop==5){}
  if ((Rebecca.x==170)&&(Rebecca.y==192)&&(Rebecca.Loop==5)){}
  else{leftovers=true; dLeftovers.Start();}
}
}

function room_AfterFadeIn(){
if (player.PreviousRoom==29){dSaveprompt.Start(); FadeObjectOut_NoBlock(block_2, 100, 75);//Dreamsave
    
    if (is_beccabreakfasting==true){//Becca Wakes Melanie
    customerlisten(); PCListen();
    TalkPop(); Wait(40);
    customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
    customertalk(); PCListen(); 
    int wakey=Random(3);
    if (approval_Rebecca<=4){
        if (wakey==0){dText.Text=("Hey, wake up already.");}
        if (wakey==1){dText.Text=("Get up, Melanie.");}
        if (wakey==2){dText.Text=("You getting up, or what?");}
        if (wakey==3){dText.Text=("Hey, you gonna sleep all day?");}
        blab1();
        customertalk(); PCListen(); dText.Text=("Breakfast is ready."); blab1();
    }
    if (approval_Rebecca>=5){
        if (wakey==0){dText.Text=("Get up, get up the sun is up!");}
        if (wakey==1){dText.Text=("Wakin' wakin', eggs and bacon!");}
        if (wakey==2){dText.Text=("Morning sunshine! Get the hell out of bed!");}
        if (wakey==3){dText.Text=("She's alive! I can't believe it!");}
        blab1(); 
        customertalk(); PCListen(); wakey=Random(3);
        if (wakey==0){dText.Text=("I already made breakfast!");}
        if (wakey==1){dText.Text=("If you don't hurry, there won't be any breakfast left for you.");}
        if (wakey==2){dText.Text=("Food's getting cold - hurry up and eat!");}
        if (wakey==3){dText.Text=("Breakfast is ready!");}
        blab1();
    }
      StopPop(); Wait(40);
       Rebecca.SetWalkSpeed(6, 6); 
       Rebecca.AddWaypoint(235, 126);
       Rebecca.AddWaypoint(252, 126);
       Rebecca.AddWaypoint(320, 194);
       Rebecca.AddWaypoint(170, 192);
    }//End Breakfast Alarm
  }//End Wake Up


if (melplot==0){//Starting out
  FadeObjectOut_NoBlock(block_3, 100, 0);
  salebuyer=("Rebecca"); 
  customerlisten(); PCListen();
  TalkPop(); Wait(40);
  customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
  while(gDialog.Y<80){gDialog.Y+=5; Wait(1);}//Experimental!
  customerlisten(); dText.Text=(" ");
  customerlisten(); PCTalk(); dText.Text=("Oh, Becca... It looks so cozy."); blab1();
  customerlisten(); PCTalk(); dText.Text=("She'll love it. She'll be so happy."); blab1();
  customertalk(); PCListen(); dText.Text=("You think so? I hope there aren't any spiders up here, or anything."); blab1();
  customerlisten(); PCTalk(); dText.Text=("Spiders? Are there? I didn't see any."); blab1();
  customertalk(); PCListen(); dText.Text=("I don't think so. But I haven't been up here since mom and dad left."); blab1();
  customerlisten(); PCTalk(); dText.Text=("It's fine. She's seen spiders before and lived through it."); blab1();
  customertalk(); PCListen(); dText.Text=("So, she'll be over tomorrow?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("Yeah. I'm picking her up tomorrow after school."); blab1();
  customerlisten(); PCTalk(); dText.Text=("We'll have her all week."); blab1();
  customerlisten(); PCListen(); dText.Text=("..."); blab1();
  //Crying
  customertalk(); PCListen(); dText.Text=("Well, you don't have to worry about cooking. I'll cook."); blab1();
  customertalk(); PCListen(); dText.Text=("It'll be nice to have people to cook for anyways. "); blab1();
  customertalk(); PCListen(); dText.Text=("Last few months, I've just been eating gondola bars in front of the TV. "); blab1();
  customertalk(); PCListen(); dText.Text=("I miss being in the kitchen. It'll be nice."); blab1();
  customerlisten(); PCTalk(); dText.Text=("Yeah, I think so. It'll be nice."); blab1();
  customerlisten(); PCListen(); dText.Text=("..."); blab1();
  customertalk(); PCListen(); dText.Text=("So, what are you gonna do about money?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("I told you about the coffee business, right?"); blab1();
  customerlisten(); PCListen(); dName.Text=("Rebecca: "); dText.Text=("...?"); blab1();
  customertalk(); PCListen(); dText.Text=("You're gonna start a new business on your own? Now?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("What's wrong with that? Isn't this the perfect opportunity?"); blab1();
  customerlisten(); PCListen(); dName.Text=("Rebecca: "); dText.Text=("..."); blab1();
  customertalk(); PCListen(); dText.Text=("...you're crazy."); blab1();
  customerlisten(); PCTalk(); dText.Text=("It's simple. I'll get a coffee cart, and an espresso machine. "); blab1();
  customerlisten(); PCTalk(); dText.Text=("A \"coffee hut\", I mean. No, wait... "); blab1();
  customerlisten(); PCTalk(); dText.Text=("A \"stand\". A \"coffee stand\"."); blab1();
  customertalk(); PCListen(); dText.Text=("Uh huh."); blab1();
  customerlisten(); PCTalk(); dText.Text=("And I'll sell coffee, Becca. What's wrong with that?"); blab1();
  customertalk(); PCListen(); dText.Text=("I might be able to offer some advice, if you want. But I don't want to preach at you."); blab1();
  
  
  customerlisten(); PCListen(); dText.Text=(" "); 
  dMel_Tutorial.Start();
  //StopPop();//This ends here until the tutorial questions are plugged in.
}//End Intro

if ((firstdayhome==true)&&(melplot!=99)&&(mel_pickeduptoday==true)&&(dayofweek>=1)){//First day walking Laura Home
  if (Laura.Room!=player.Room){Laura.ChangeRoom(2, player.x+10, player.y);} firstdayhome=false;
  salebuyer=("Laura"); 
  customerlisten(); PCListen();
  TalkPop(); Wait(40);
  customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
  customerlisten(); dText.Text=(" ");
  customertalk(); PCListen(); dText.Text=("Smells good in here!"); blab1();
  customerlisten(); PCTalk(); dText.Text=("It's all the great food Aunt Becca cooks."); blab1();
  customertalk(); PCListen(); dText.Text=("Want to help me pull out the couch bed?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("No, sweety. Your room is in the attic."); blab1();
  customerlisten(); PCTalk(); dText.Text=("We set put up bookshelves and made up a bed for you."); blab1();
  customertalk(); PCListen(); dText.Text=("In the attic? Okay."); blab1();
  customertalk(); PCListen(); dText.Text=("Were there spiders?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("I don't think so. We didn't see any."); blab1();
  customertalk(); PCListen(); dText.Text=("You'll know I've found one when I start screaming."); blab1();
  customerlisten(); PCTalk(); dText.Text=("Make sure to communicate the size of the spider by the volume of your scream."); blab1();
  customertalk(); PCListen(); dText.Text=("Oh, of course."); blab1();
  customerlisten(); PCListen(); dText.Text=(" ");  
  StopPop();
       Laura.Walk(320, 194, eNoBlock, eAnywhere);
       Laura.AddWaypoint(252, 126);
       Laura.AddWaypoint(235, 126);
       Laura.AddWaypoint(302, 59);
       Laura.AddWaypoint(210, 59);
  }

if ((melplot==99)&&(mel_pickeduptoday==false)){//Where's Laura
  salebuyer=("Rebecca"); 
  customerlisten(); PCListen();
  TalkPop(); Wait(40);
  customerlisten(); PCListen(); dName.Text=(" "); dText.Text=(" ");
  customerlisten(); dText.Text=(" ");
  customertalk(); PCListen(); dText.Text=("Oh my god, Melanie. Where've you been?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("I was just running some errands! Why are you freaking out?"); blab1();
  customertalk(); PCListen(); dText.Text=("I thought you were picking up Laura at school today. Where is she?"); blab1();
  customerlisten(); PCTalk(); dText.Text=("I..."); blab1();
  customerlisten(); PCTalk(); dText.Text=("I didn't make it over to the school, okay? I don't know where she is."); blab1();
  customertalk(); PCListen(); dText.Text=("You don't know where she is."); blab1();
  customertalk(); PCListen(); dText.Text=("Your eleven year old daughter."); blab1();
  customerlisten(); PCTalk(); dText.Text=("I thought she'd be here when I came home, okay?!"); blab1();
  customerlisten(); PCTalk(); dText.Text=("She knows she's staying here this week - I thought she'd take the bus or something."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("\"Or something\"?!"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Mel, what if something happened to her!"); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Don't you think I'm worried too?!"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("You're not worried enough! Did you check at the school already?"); blab1();
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=(" ");  
  dBecca_badmom1.Start();
}//end badmom

if ( ((dayspassed==2)&&(milhour>=16)) || ((dayspassed>=3)&&(checkedin_hearing==false))){//Court Day -> Coming Home
  checkedin_hearing=true;
  Rebecca.ChangeRoom(2, 390, 192); Rebecca.Animate(0, 3, eRepeat, eNoBlock);
  salebuyer=("Rebecca"); 
  customerlisten(); PCListen();
  TalkPop(); Wait(40);
  if (mel_wentcourt==false){//Didn't go to the hearing.
  mel_lostcustody=true;
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Melanie...?"); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Hey, Becca."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Hey, listen..."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("There's bad news."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("What do you mean? What is it?"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Seth came and got Laura."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("He said you didn't go to the hearing today?"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("You didn't go?"); blab1();
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dName.Text=("Melanie: "); dText.Text=("..."); blab1(); Wait(30);
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("I just didn't have time."); blab1();
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dName.Text=("Rebecca: "); dText.Text=("..."); blab1(); Wait(30);
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Well..."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("He told me that they rescheduled the hearing for Monday."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("...and that he still wants to split custody."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Okay..."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("So we're just meeting on monday, then?"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Yeah, but the judge wants to make sure your new job is making money."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("He wants proof that your life is, you know, \"stable\"."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Okay."); blab1();
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dName.Text=("Melanie: "); dText.Text=("..."); blab1(); Wait(30);
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dName.Text=("Rebecca: "); dText.Text=("..."); blab1(); Wait(30);
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("I made dinner. If you want some I can heat it up."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("I just need a minute."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Sure."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("And seth has Laura?"); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Just until the hearing on Monday."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Seth told me the Judge wanted you to use the time to get set up."); blab1();
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("...and not have to worry about taking Laura to school."); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Okay. Cool."); blab1();
  customerlisten(); PCListen(); DBG2.Animate(255, 5, 2, eRepeat); dName.Text=("Rebecca: "); dText.Text=("..."); blab1(); Wait(30);
  customertalk(); PCListen(); DBG2.Animate(255, 4, 2, eRepeat); dText.Text=("Come eat when you're ready, okay?"); blab1();
  customerlisten(); PCTalk(); DBG2.Animate(255, 5, 2, eRepeat); dText.Text=("Yeah, okay."); blab1();
  customerlisten(); PCListen(); dText.Text=(" "); 
  StopPop(); Wait(40);
  Rebecca.Walk(170, Rebecca.y, eNoBlock, eAnywhere);  
  }
  else if (mel_wentcourt==true){//Went to the hearing.
  customertalk(); PCListen(); dText.Text=("Hey, Melasaurus."); blab1();
  customerlisten(); PCTalk(); dText.Text=("Yeah, hey."); blab1();
  customertalk(); PCListen(); dText.Text=("How was the hearing?"); blab1();
  customerlisten(); PCListen(); dText.Text=(" "); 
    if (mel_lostcustody==true){//Lost Custody
    dCheckinBad.Start();
    return;
    }
    else if (mel_lostcustody!=true){//Ready to rock
    customerlisten(); PCTalk(); dText.Text=("We're meeting again on Monday."); blab1();
    customertalk(); PCListen(); dText.Text=("You are? For what?"); blab1();
    customerlisten(); PCTalk(); dText.Text=("The judge wants to make sure the stand can make money."); blab1();
    customertalk(); PCListen(); dText.Text=("Oh, okay."); blab1();
    customerlisten(); PCListen(); dText.Text=("..."); blab1();
    customertalk(); PCListen(); dText.Text=("That doesn't sound like a big deal."); blab1();
    customerlisten(); PCTalk(); dText.Text=("Yeah. I guess not."); blab1();
    customerlisten(); PCTalk(); dText.Text=("But he didn't say how much I need to make or anything."); blab1();
    customerlisten(); PCTalk(); dText.Text=("Just that his \"plausibility concerns\" need to be \"addressed\"."); blab1();
    customertalk(); PCListen(); dText.Text=("Oh."); blab1();
    customertalk(); PCListen(); dText.Text=("Well, you should be fine, either way."); blab1();
    customertalk(); PCListen(); dText.Text=("It sounds like everything's gonna be fine."); blab1();
    customerlisten(); PCTalk(); dText.Text=("Right."); blab1();
    customertalk(); PCListen(); dText.Text=("Come on inside and eat."); blab1();
    }
  customerlisten(); PCListen(); dText.Text=(" "); 
  StopPop();
  Rebecca.Walk(170, Rebecca.y, eNoBlock, eAnywhere);
  }
}//End Court Day Coming Home
 
 if ((milhour==5)||(milhour==6)){//Early Wake
                                 if (Rebecca.Room!=2){//Related to a "character not in room" bug reported on the basillica
                                    Rebecca.ChangeRoom(2, 310, 125); 
                                    Rebecca.Baseline=10; 
                                    Rebecca.Animate(0, 3, eRepeat, eNoBlock);}
                                 beccadoor.SetView(265, 0); beccadoor.Animate(1, 2, eOnce, eNoBlock, eForwards);
                                 Rebecca.Baseline=0; Rebecca.Transparency=0;
                                 //Rebecca.SetWalkSpeed(6, 6); 
                                 Rebecca.AddWaypoint(235, 126);
                                 Rebecca.AddWaypoint(252, 126);
                                 Rebecca.AddWaypoint(320, 194);
                                 Rebecca.AddWaypoint(170, 192);
                                }

}


//R.E.A.
function repeatedly_execute_always(){
    if ((player.View==80)&&(player.x>215)){//Because she wakes up in PJs
        player.UnlockView(); player.ChangeView(2); player.SetIdleView(2, 0);}
}

function region1_WalksOff(){block_2.Visible=true; block_2.Transparency=0;}
function region2_WalksOff(){block_1.Visible=true; block_1.Transparency=0;}

function region10_Standing(){//CPU PASSWORD
if (((IsKeyPressed(372)==1)||(IsKeyPressed(87)==1))&&(gSavegame.Visible==false)&&(gLoadgame.Visible==false)&&(gMake.Visible==false)&&(gBuyortalk.Visible==false)&&(gStock.Visible==false)){//UP
if ((Laura.y<140)||(Laura.Room!=2)){
if ((cheatbiking==false)&&(gMake.Visible==false)&&(gTip.Visible==false)){PlaySound(28); Wait(5);
tipdollarsign.Visible=false;
TipBalance.Text=(String.Format("This account is protected."));
CloseAll(); gTip.Centre(); TipHeader.Text=("Enter Password:"); gTip.Visible=true; Wait(3);}}}}
